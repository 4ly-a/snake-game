<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="home.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Snake Game</title>
  </head>
  <body>
    <h1 class="title">Snake Game</h1>
    <h1 class="title-back">Snake Game</h1>
    <p class="description">
      Game created to learn more about JavaScript. Press space button to start
      To move use:
    </p>

    <div class="info">
      <h1 id="frase"></h1>
      <h1 id="pontos"></h1>
    </div>

    <div class="buttons">
      <div class="w-b" id="w"><h3>w</h3></div>
      <div class="w-b" id="a"><h3>a</h3></div>
      <div class="w-b" id="s"><h3>s</h3></div>
      <div class="w-b" id="d"><h3>d</h3></div>
    </div>
    <div class="circle">
      <canvas id="stage" width="600" height="600"></canvas>
    </div>
    
    <!-- <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <div class="animation">
      <lottie-player
      src="https://assets5.lottiefiles.com/datafiles/l2wP2eVNuQZTnHt/data.json"
      background="transparent"
      speed="1"
      style="width: 300px; height: 300px;"
      loop
      autoplay
    ></lottie-player> -->

    </div>
    <script type="text/javascript">
      window.onload = function () {
        var mensagem = document.getElementById("frase");
        var stage = document.getElementById("stage");
        var ctx = stage.getContext("2d");
        document.addEventListener("keydown", keyPush);
        setInterval(game, 90);
        var pontos = document.getElementById("pontos");
        let points = 0;
        const speed = 1;
        var speedX = (speedY = 0);
        var positionX = 10;
        var positionY = 15;
        var tp = 30;
        var qp = 20;
        var appleX = (appleY = 15);
        var trail = [];
        tail = 1;
        var head = trail[0];

        function gameOver() {
          points = 0;
          pontos.textContent = points;
          tail = 1;
          mensagem.textContent = "Perdeu :(";
        }

        function game() {
          mensagem.textContent = "";
          positionX += speedX;
          positionY += speedY;
          if (positionX < 0) {
            positionX = qp - 1;
          }
          if (positionX > qp - 1) {
            positionX = 0;
          }
          if (positionY < 0) {
            positionY = qp - 1;
          }
          if (positionY > qp - 1) {
            positionY = 0;
          }

          ctx.fillStyle = "white";
          ctx.fillRect(0, 0, stage.width, stage.height);

          ctx.fillStyle = "#edf044";
          ctx.fillRect(appleX * tp, appleY * tp, tp, tp);

          ctx.fillStyle = "#000";
          for (var i = 0; i < trail.length; i++) {
            ctx.fillRect(trail[i].x * tp, trail[i].y * tp, tp - 1, tp - 1);
            if (trail[i].x == positionX && trail[i].y == positionY) {
              gameOver();
            }
          }

          trail.push({ x: positionX, y: positionY });
          while (trail.length > tail) {
            trail.shift();
          }

          if (appleX == positionX && appleY == positionY) {
            tail++;
            points++;
            pontos.textContent = points;
            appleX = Math.floor(Math.random() * qp);
            appleY = Math.floor(Math.random() * qp);
          }
        }

        function keyPush(event) {
          switch (event.keyCode) {
            case 65: // Left
              speedX = -speed;
              speedY = 0;
              break;
            case 87: // up
              speedX = 0;
              speedY = -speed;
              break;
            case 68: // right
              speedX = speed;
              speedY = 0;
              break;
            case 83: // down
              speedX = 0;
              speedY = speed;
              break;
            default:
              break;
          }
        }
      };
    </script>
  </body>
</html>
